"use strict";(self.webpackChunk_phaser_plus_docs=self.webpackChunk_phaser_plus_docs||[]).push([[6112],{6774:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(7378),n=s(8944);const r="header_OUBe",a=e=>{const{title:t="[TITLE HERE]",description:s="[DESCRIPTION HERE]"}=e;return i.createElement("header",{className:r},i.createElement("div",{className:"container"},i.createElement("div",{className:"row"},i.createElement("div",{className:(0,n.Z)("col col--6 col--offset-3")},i.createElement("h1",null,t))),i.createElement("div",{className:"row"},i.createElement("div",{className:(0,n.Z)("col col--6 col--offset-3")},i.createElement("p",null,s)))))}},1657:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(7378),n=s(8944),r=s(551),a=s(1728);class o extends i.Component{constructor(){super(...arguments),this.game=null,this.state={title:"Please wait",file:"Loading..."}}componentDidMount(){this.game=new a.Game({type:a.AUTO,parent:"game_canvas",scale:{mode:a.Scale.FIT,autoCenter:a.Scale.CENTER_BOTH},physics:{default:"matter",matter:{debug:!0}},dom:{createContainer:!0},antialias:!0,width:1280,height:720});let e=this.props.entry;this.game.scene.add("demo",new e.sceneClass),this.game.scene.start("demo"),fetch(`https://raw.githubusercontent.com/kalevski/phaser-plus/main/examples/src/${e.sceneFile}`).then((e=>e.text())).then((t=>{this.setState({title:e.sceneFile,file:t})}))}componentWillUnmount(){console.log("here ?")}render(){const{title:e,file:t}=this.state;return i.createElement("div",{className:"container"},i.createElement("div",{className:"row"},i.createElement("div",{className:(0,n.Z)("col col--8 col--offset-2")},i.createElement("div",{id:"game_canvas"}))),i.createElement("div",{className:"row"},i.createElement("div",{className:(0,n.Z)("col col--8 col--offset-2")},i.createElement(r.Z,{language:"js",title:e,showLineNumbers:!0},t))))}}const l=o},83:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var i=s(7378),n=s(3829),r=s(3099);const a="Examples",o="Tools and extensions to make HTML5 game development easier and fun using PhaserJS";function l(){return i.createElement(n.Z,{title:a,description:o},i.createElement(r.Z,null,(()=>{let e=(0,s(24).z)(new URL(window.location.href).searchParams.get("demo"));const t=s(1657).Z,n=s(6774).Z;return i.createElement(i.Fragment,null,i.createElement(n,{title:e.title,description:e.description}),i.createElement("main",null,i.createElement(t,{entry:e})))})))}},24:(e,t,s)=>{s.d(t,{p:()=>te,z:()=>ee});var i=s(6282),n=s(1728),r=s(2118),a=s(1586),o=s.n(a);class l extends n.GameObjects.Container{constructor(e,t,s){super(e,t,s),this.scene=null,this.game=null,this.id=null,this._abs=new n.Math.Vector2(0,0),this.scene=e,this.game=e.game,this.id=(0,r.Ox)(16)}get absolute(){this._abs.set(this.x,this.y);let e=this.parentContainer;for(;e instanceof n.GameObjects.GameObject;)this._abs.x+=e.x,this._abs.y+=e.y,e=e.parentContainer;return this._abs}onCreate(){}onAdd(e){}contains(e,t){return!1}onUpdate(e,t){}onRemove(e){}onDestroy(){}preDestroy(){super.preDestroy(),this.onDestroy()}add(e){if(super.add(e),Array.isArray(e))for(let t of e)t instanceof l&&t.onAdd(this);else e instanceof l&&e.onAdd(this);return this}remove(e,t){if(void 0===t&&(t=!1),Array.isArray(e))for(let s of e)s instanceof l&&s.onRemove(this);else e instanceof l&&e.onRemove(this);return super.remove(e,t)}removeAll(e){void 0===e&&(e=!1);for(let t of this.list)t instanceof l&&t.onRemove(this);return super.removeAll(e)}doUpdate(e,t){this.onUpdate(e,t);for(let s of this.list)s instanceof l&&s.doUpdate(e,t)}}var h=l,c=class extends i.mA{constructor(){super([new i.rC]),this.level=i.aC.VERBOSE}},d=class{constructor(){this.version="0.0.1",this.services=null,this.logging=new c,this.logging.level=i.aC.VERBOSE,this.services=new class{constructor(){this.services=new Map}resolve(e){let t=this.getServiceType(e);if(this.services.has(t))return this.services.get(t)||null;let s=new e;return this.services.set(t,s),s}dispose(e){let t=this.getServiceType(e);this.services.delete(t)}disposeAll(){this.services.clear()}getServiceType(e){if("function"!=typeof e)throw new Error("provided serviceClass is not a class");return o()(e.toString())}},this.getLogger().info(`v${this.version} initialized`)}setLogLevel(e){this.logging.level=e}getLogger(e){return void 0===e&&(e="@toolcase/phaser-plus"),this.logging.getLogger(e)}},u=class{constructor(e,t){this.scene=null,this.game=null,this.key=null,this.logger=null,this.scene=e,this.game=e.game,this.key=t,this.logger=this.scene.engine.getLogger(`feature=${t}`)}onCreate(){}onUpdate(e,t){}preDestroy(){}onDestroy(){}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];if(0===this.scene.features.events.listenerCount(e))return this.logger.warning(`event=(${e}) is not handled, payload sent:`,...s);super.emit(e,...s)}},p=class extends r.zv{constructor(e){super(),this.scene=null,this.features=new Map,this.featureKeys=[],this.dirty=!1,this.scene=e}get keys(){return!1===this.dirty||(this.featureKeys=[],this.features.forEach(((e,t)=>this.featureKeys.push(t))),this.dirty=!1),this.featureKeys}register(e,t){if(this.features.has(e))throw new Error(`key ${e} is already in use by other feature`);if("function"!=typeof t)throw new Error(`featureClass provided [${t}] is not a class`);let s=new t(this.scene,e);if(!(s instanceof u))throw new Error("featureClass must extends Feature class ");return s.onCreate(),this.features.set(e,s),this.dirty=!0,s}get(e){return this.features.get(e)||null}destroy(e){let t=this.get(e);null!==t&&(t.preDestroy(),t.onDestroy(),this.features.delete(e),this.dirty=!0)}destroyAll(){for(let e of this.keys)this.destroy(e)}doUpdate(e,t){for(let s of this.keys)this.get(s).onUpdate(e,t)}},m=class{constructor(e,t){this.scene=null,this.eventType=null,this.scene=e,this.eventType=t}onCreate(){}onUpdate(e,t){}onDestroy(){}};class f{constructor(){this.event=null,this.name=null,this.time=null,this.payload=null}}var v=class extends m{constructor(){super(...arguments),this.TIMEOUT_FN_NAME="@toolcase/phaser-plus/timeoutFn",this.timerDefPool=new r.L7(f),this.queue=[],this.eventMap=new Map}get keys(){let e=[];return this.eventMap.forEach(((t,s)=>e.push(s))),e}onCreate(){}onUpdate(e,t){let s=[];for(let i=0;i<this.queue.length;i++){let e=this.queue[i];e.time+=t/1e3,e.time>0&&(e.name===this.TIMEOUT_FN_NAME?(e.event.call(e.payload),s.unshift(i)):(e.event.onFire(e.payload),s.unshift(i)))}for(let i of s){let[e]=this.queue.splice(i,1);this.timerDefPool.release(e)}}onDestroy(){this.queue=[];for(let e of this.eventMap.keys())this.remove(e)}add(e,t){if(this.eventMap.has(e))throw new Error(`event with name=${e} is already registered`);let s=new t(this.scene);if(s.type!==this.eventType)throw new Error(`provided event with type ${s.type}, ${this.eventType} is acceptable`);return this.eventMap.set(e,s),s.onCreate(),this}remove(e){return this.eventMap.has(e)&&(this.eventMap.get(e).onDestroy(),this.eventMap.delete(e)),this}trigger(e,t,s){if(void 0===s&&(s=0),!this.eventMap.has(e))throw new Error(`event name=${e} is not registered`);if("number"!=typeof s||s<0)throw new Error("delay must be a positive number");let i=this.timerDefPool.obtain();return i.name=e,i.time=-s,i.event=this.eventMap.get(e),i.payload=t,this.queue.push(i),this}triggerFn(e,t,s){if(void 0===t&&(t=0),void 0===s&&(s=null),"number"!=typeof t||t<0)throw new Error("delay must be a positive number");if("function"!=typeof e)throw new Error("callbackFn must be a function");let i=this.timerDefPool.obtain();return i.name=this.TIMEOUT_FN_NAME,i.time=-t,i.event=e,i.payload=s,this.queue.push(i),this}},g=class extends m{constructor(){super(...arguments),this.timers=[]}onUpdate(e,t){for(let s of this.timers)s.current+=t/1e3,s.current>s.interval&&(s.current-=s.interval,s.counter++,s.event.onFire(s.counter))}onDestroy(){let e=this.timers.map((e=>e.id));for(let t of e)this.remove(t)}add(e,t,s,i){if(void 0===s&&(s=1),void 0===i&&(i=0),"number"!=typeof s||s<=0)throw new Error("interval must be a number greater then 0");if("number"!=typeof i||i<0)throw new Error("interval must be a positive number");if(null!==(this.timers.find((t=>t.id===e))||null))throw new Error(`timer with id=${e} is already registered`);let n=new t(this.scene);if(n.type!==this.eventType)throw new Error(`provided event with type ${n.type}, ${this.eventType} is acceptable`);return this.timers.push({id:e,current:-i,interval:s,event:n,counter:0}),n.onCreate(),this}remove(e){let t=this.timers.findIndex((t=>t.id===e));return-1!==t&&(this.timers[t].event.onDestroy(),this.timers.splice(t,1)),this}},y=class extends m{constructor(){super(...arguments),this.eventMap=new Map,this.logger=null,this.matrix=null}onCreate(){this.logger=this.scene.engine.getLogger("collision events"),this.matrix=new r.ff([],null),this.scene.matter.world.on(n.Physics.Matter.Events.COLLISION_START,this.onCollisionEnter,this),this.scene.matter.world.on(n.Physics.Matter.Events.COLLISION_END,this.onCollisionExit,this)}onUpdate(e,t){}onDestroy(){for(let e of this.eventMap.keys())this.removeEvent(e)}createEvent(e,t){if(this.eventMap.has(e))return this.logger.warning(`[createEvent] collision event for object ${e} is already registered`),this;let s=new t(this.scene);return s.type!==this.eventType?(this.logger.warning(`[createEvent] provided event with type ${s.type}, ${this.eventType} is acceptable`),this):(this.eventMap.set(e,s),s.onCreate(),this)}removeEvent(e){return this.eventMap.has(e)?(this.eventMap.get(e).onDestroy(),this.eventMap.delete(e),this):(this.logger.warning(`provided event with type ${event.type}, ${this.eventType} is acceptable`),this)}setCollision(e,t,s){return this.eventMap.has(s)?(this.matrix.addVertex(e),this.matrix.addVertex(t),this.matrix.addEdge(e,t,s),this.matrix.addEdge(t,e,s),this):(this.logger.warning(`[setCollision] event name=${s} does not exist`),this)}removeCollision(e,t){this.matrix.removeEdge(e,t),this.matrix.removeEdge(t,e)}onCollisionEnter(e,t,s){let i=this.matrix.getEdge(t.label,s.label);if(null===i)return;let n=this.eventMap.get(i)||null;null!==n?n.onEnter(t,s,e):this.logger.warning(`[on collision enter] event ${i} is not registered`)}onCollisionExit(e,t,s){let i=this.matrix.getEdge(t.label,s.label);if(null===i)return;let n=this.eventMap.get(i)||null;null!==n?n.onExit(t,s,e):this.logger.warning(`[on collision enter] event ${i} is not registered`)}},b=class extends m{constructor(){super(...arguments),this.queue=[]}get queuedJobs(){return this.queue.length}onCreate(){}onUpdate(e){let t=this.queue.shift()||null;if(null===t)return;let s=null;try{s=t.onUpdate(e)}catch(e){return t.onTerminate(e)}!0===("boolean"==typeof s&&s)?t.onComplete():this.queue.push(t)}onDestroy(){for(;this.queue.length>0;)this.queue.pop().onTerminate()}run(e,t){void 0===t&&(t=null);let s=new e(this.scene,t);if(s.type!==this.eventType)throw new Error("provided job must be an instance of Job class");return s.onCreate(),this.queue.push(s),s}},w=class{constructor(e){this.active=!0,this.scene=null,this.events=null,this.timer=null,this.physics=null,this.jobs=null,this.timeLoop=null,this.logger=null,this.processors=[],this.scene=e,this.logger=this.scene.engine.getLogger("flow"),this.events=this.addProcessor("event",v),this.timer=this.addProcessor("time_event",g),this.jobs=this.addProcessor("job",b),void 0!==this.scene.matter&&(this.physics=this.addProcessor("collision_event",y))}addProcessor(e,t){if("string"!=typeof e)throw new Error(`event type must be a string, ${typeof e} provided`);let s=this.getProcessor(e);return null!==s?this.logger.warning(`event type: ${e} already have a processor`):(s=new t(this.scene,e),s.onCreate(),this.processors.push(s),s)}getProcessor(e){return this.processors.find((t=>t.eventType===e))||null}destroy(){for(;this.processors.length>0;)this.processors.pop().onDestroy()}doUpdate(e,t){if(!1!==this.active)for(let s of this.processors)s.onUpdate(e,t)}},x=class extends n.Scene{constructor(){super(...arguments),this.engine=null,this.services=null,this.features=null,this.flow=null,this.pool=null,this.logger=null}onInit(){}onLoad(){}onCreate(){}onDestroy(){}goTo(e,t){"object"!=typeof t&&(t=null),this.doDestroy(),this.scene.stop(),this.game.scene.start(e,t)}get payload(){return"object"==typeof this.scene.settings.data?this.scene.settings.data:{}}beforeInit(){}init(){this.engine=this.initializeEngine(),this.events.once(n.Scenes.Events.DESTROY,this.doDestroy,this),this.logger=this.engine.getLogger(`scene=${this.scene.key}`),this.services=this.engine.services,this.features=new p(this),this.pool=new class{constructor(e){this.scene=null,this.logger=null,this.map=new Map,this.scene=e,this.logger=e.engine.getLogger("pool")}get keys(){let e=[];return this.map.forEach(((t,s)=>e.push(s))),e}get instances(){let e=0;return this.map.forEach((t=>{e+=t.instances})),e}register(e,t,s,i){if(void 0===s&&(s=null),void 0===i&&(i=null),this.map.has(e))return this.logger.error(`game object ${e} is already registered`),this;null===s&&(s=this.createInstance);let n=new r.L7(t,i,(t=>s(e,t,this.scene)));return this.map.set(e,n),this}obtain(e){let t=this.map.get(e)||null;if(null===t)return this.logger.error(`game object ${e} is not registered`),null;let s=t.obtain();return this.onObjectCreate(s),s}release(e){return"function"==typeof e.release?(e.release(),this.scene.children.remove(e)):this.logger.warning("can not be released, the object is not created by the pool",gameObject),this}dispose(){this.map.forEach((e=>{e.dispose()})),this.map.clear()}createInstance(e,t,s){return new t(s)}onObjectCreate(e){"boolean"!=typeof e.poolable&&(e.poolable=!0,"function"==typeof e.onCreate&&e.onCreate(),this.scene.add.existing(e))}}(this),this.flow=new w(this),this.logger.info("initialized"),this.beforeInit(),this.onInit()}preload(){this.onLoad()}create(){this.onCreate()}update(e,t){this.features.doUpdate(e,t);for(let s of this.children.list)s instanceof h&&s.doUpdate(e,t);this.flow.doUpdate(e,t)}doDestroy(){this.onDestroy(),this.features.destroyAll(),this.flow.destroy(),this.pool.dispose()}initializeEngine(){return this.game.engine instanceof d||(this.game.engine=new d),this.game.engine}};class E extends Float32Array{constructor(e,t,s,i,n){void 0===e&&(e=1),void 0===t&&(t=1),void 0===s&&(s=1),void 0===i&&(i=1),void 0===n&&(n=null),super(4),this.PRECISION=1e4,this.adjoint=new Float32Array(4),this.inverse=null,this.determinant=0,this.setValues(e,t,s,i,n)}get v00(){return this[0]}get v01(){return this[1]}get v10(){return this[2]}get v11(){return this[3]}translate(e,t,s){return void 0===s&&(s=new n.Math.Vector2),s.x=Math.round((e*this[0]+t*this[1])*this.PRECISION)/this.PRECISION,s.y=Math.round((e*this[2]+t*this[3])*this.PRECISION)/this.PRECISION,s}setValues(e,t,s,i,n){if(void 0===n&&(n=null),this[0]=e,this[1]=t,this[2]=s,this[3]=i,this.adjoint[0]=i,this.adjoint[1]=-t,this.adjoint[2]=-s,this.adjoint[3]=e,this.determinant=1/(this[0]*this[3]-this[1]*this[2]),null!==n)return void(this.inverse=n);let r=this.adjoint[0]*this.determinant,a=this.adjoint[1]*this.determinant,o=this.adjoint[2]*this.determinant,l=this.adjoint[3]*this.determinant;this.inverse=new E(r,a,o,l,this)}}E.createISO=function(e){return void 0===e&&(e=64),new E(e,-e,e/2,e/2)},E.create=function(e,t,s,i){void 0===e&&(e=1),void 0===t&&(t=1),void 0===s&&(s=0),void 0===i&&(i=0);let r=new n.Math.Vector2(e,0),a=new n.Math.Vector2(0,t);return r.rotate(n.Math.DegToRad(s)),a.rotate(n.Math.DegToRad(i)),new E(r.x,r.y,a.x,a.y)};var T=E,C=class extends u{constructor(){super(...arguments),this.CAMERA_NAME=(0,r.Ox)(16),this.container=null,this.layerLoop=null}onCreate(){if(""===this.scene.cameras.main.name)this.scene.cameras.main.setName(this.CAMERA_NAME);else{const{width:e,height:t}=this.game.config;this.scene.cameras.add(0,0,e,t,!1,this.CAMERA_NAME)}this.camera.centerOn(0,0),this.container=new h(this.scene,0,0),this.scene.add.existing(this.container),this.layerLoop=this.scene.time.addEvent({delay:100,callback:this.onLayerUpdate,callbackScope:this,loop:!0}),this.onLayerUpdate()}set visible(e){return void 0===e&&(e=!0),this.container.setVisible(e),this.visible}get visible(){return this.container.visible}onLayerUpdate(){this.container.cameraFilter=this.cameraFilter}onDestroy(){this.container.destroy(),this.container=null,this.camera.id===this.scene.cameras.main.id?this.camera.setName(""):this.scene.cameras.remove(this.camera),this.layerLoop.remove(),this.layerLoop.destroy()}get camera(){return this.scene.cameras.getCamera(this.CAMERA_NAME)}get cameraFilter(){let e=this.camera.id,t=0;for(let s of this.scene.cameras.cameras)s.id!==e&&(t|=s.id);return t}get list(){return this.container.list}getByName(e){return this.container.getByName(e)}};class L extends u{constructor(e,t){super(e,t),this._node=null;let s=this.game.domContainer;if(null===s)throw new Error("dom container is not enabled, enable by setting dom.createContainer inside config");L.setup(),this._node=window.document.createElement("div"),this._node.setAttribute("id",`feature-${t}`),this._node.classList.add("html-feature"),this._node.classList.add(`feature-${t}`),s.append(this._node)}get node(){return this._node}preDestroy(){super.preDestroy(),this._node.remove(),this._node=null}}L.setup=()=>{let e=document.getElementById("@toolcase/phaser-plus/dom");if(null!==e)return null;e=document.createElement("style"),e.id="@toolcase/phaser-plus/dom",e.innerHTML="\n    .html-feature {\n        pointer-events: none;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n    }\n    .html-feature * {\n        pointer-events: auto;\n        user-select: none;\n    }",document.head.append(e)};var j=L;const O=class{constructor(e){this.scene=null,this.flow=null,this.scene=e,this.flow=this.scene.flow}onCreate(){}onFire(){}onDestroy(){}get type(){return"event"}},S={Matrix2:T};var M=class extends h{constructor(e,t){super(e,0,0),this.context=null,this.transform=new n.Math.Vector2(0,0),this.pivot=new n.Math.Vector2(0,0),this.context=t}get projection(){return this.context.projection}setTransform(e,t){return this.projection.translate(e,t,this),this.transform.set(e,t),this}setTransformX(e){return this.setTransform(e,this.transform.y)}setTransformY(e){return this.setTransform(this.transform.x,e)}addTag(e){return this}removeTag(e){return this}removeTags(){}doUpdate(e,t){super.doUpdate(e,t),this.projection.inverse.translate(this.x,this.y,this.transform),this.pivot.set(this.transform.x,this.transform.y)}},I=class extends h{constructor(){super(...arguments),this.TEXTURE_KEY="",this.TILE_PRECISION=7,this.canvas=null,this.gridTile=null}onCreate(){this.TEXTURE_KEY=`@toolcase/phaser+grid-${(0,r.Ox)(4)}`;const{width:e,height:t}=this.game.config;this.gridTile=this.scene.add.tileSprite(0,0,e,t).setVisible(!1).setOrigin(0),this.add(this.gridTile)}setCanvasStyle(){this.canvas.fillStyle(5862794,1),this.canvas.lineStyle(1,16777215,.3)}onDestroy(){}setProjection(e){this.canvas=this.scene.add.graphics(),this.setCanvasStyle(),this.add(this.canvas),this.scene.textures.exists(this.TEXTURE_KEY)&&this.scene.textures.remove(this.TEXTURE_KEY),this.gridTile.setVisible(!1);let t=this.getProjectionTileSize(e),s=0;for(let i of e)s=Math.max(s,Math.abs(i));s<25?this.drawBackground():0===t.x||0===t.y?this.drawLinearTiles(e):this.drawGridTiles(e,t),this.canvas.clear(),this.canvas.destroy(),this.gridTile.setTexture(this.TEXTURE_KEY),this.gridTile.setVisible(!0)}move(e){this.gridTile.setTilePosition(e.scrollX,e.scrollY)}drawGridTiles(e,t){let s=this.TILE_PRECISION,i=new n.Math.Vector2(0,0),r=new n.Math.Vector2(0,0),a=new n.Math.Vector2(0,0),o=new n.Math.Vector2(0,0);this.canvas.fillRect(0,0,t.x,t.y);for(let n=-s;n<s;n++)for(let t=-s;t<s;t++)e.translate(n,t,i),e.translate(n,t+1,r),e.translate(n+1,t,a),e.translate(n+1,t+1,o),this.canvas.beginPath(),this.canvas.moveTo(i.x,i.y),this.canvas.lineTo(r.x,r.y),this.canvas.lineTo(o.x,o.y),this.canvas.strokePath();this.canvas.generateTexture(this.TEXTURE_KEY,t.x,t.y)}drawLinearTiles(e){let t=new n.Math.Vector2(0,0);e.translate(2,2,t),this.canvas.fillRect(0,0,t.x,t.y),this.canvas.lineStyle(1,16777215,.2),this.canvas.strokePoints([e.translate(.8,1),e.translate(1.2,1)]),this.canvas.strokePoints([e.translate(1,.8),e.translate(1,1.2)]),this.canvas.generateTexture(this.TEXTURE_KEY,t.x,t.y)}drawBackground(){this.canvas.fillRect(0,0,100,100),this.canvas.lineStyle(1,16777215,.1),this.canvas.strokeCircle(50,50,3),this.canvas.generateTexture(this.TEXTURE_KEY,100,100)}getProjectionTileSize(e){let t=new n.Math.Vector2(e.translate(1,0).x,e.translate(0,1).y);t.x=Math.abs(t.x),t.y=Math.abs(t.y);let s=new n.Math.Vector2,i=new n.Math.Vector2,r=0,a=0;for(;a<this.TILE_PRECISION;)if(r+=t.x,a++,e.inverse.translate(r,0,i),i.x=Math.round(10*i.x)/10,i.y=Math.round(10*i.y)/10,i.y%1==0&&i.y%1==0){s.x=Math.round(r);break}let o=0,l=0;for(;l<this.TILE_PRECISION;)if(o+=t.y,l++,e.inverse.translate(0,o,i),i.x=Math.round(10*i.x)/10,i.y=Math.round(10*i.y)/10,i.x%1==0&&i.y%1==0){s.y=Math.round(o);break}return s}},R=class extends C{constructor(){super(...arguments),this.grid=null,this.gridUpdate=null,this._projection=S.Matrix2.create(50,50),this.depth=new class{constructor(){this.sortFn="normalSort",this.normalSort=(e,t)=>{let s=e.pivot.y-t.pivot.y;return 0!==s?s:e.pivot.x-t.pivot.x},this.inverseXSort=(e,t)=>{let s=e.pivot.y-t.pivot.y;return 0!==s?s:t.pivot.x-e.pivot.x},this.inverseYSort=(e,t)=>{let s=t.pivot.y-e.pivot.y;return 0!==s?s:e.pivot.x-t.pivot.x},this.inverseSort=(e,t)=>{let s=t.pivot.y-e.pivot.y;return 0!==s?s:t.pivot.x-e.pivot.x},this.disabledSort=()=>{}}setup(){this.sortFn="normalSort"}disable(){this.sortFn="disabledSort"}set(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),e||t?e&&!t?this.sortFn="inverseXSort":!e&&t?this.sortFn="inverseYSort":e&&t&&(this.sortFn="inverseSort"):this.sortFn="normalSort"}get fn(){return this[this.sortFn]}},this.createInstanceFn=(e,t,s)=>new t(s,this)}onCreate(){this.grid=new I(this.scene,0,0),this.scene.add.existing(this.grid),this.grid.onCreate(),this.grid.setScrollFactor(0),this.grid.setVisible(!1),super.onCreate(),this.onLayerUpdate()}onLayerUpdate(){super.onLayerUpdate(),this.grid.cameraFilter=this.container.cameraFilter,this.grid.move(this.camera),null!==this.gridUpdate&&(this.grid.setVisible(this.gridUpdate),this.gridUpdate&&this.grid.setProjection(this._projection),this.gridUpdate=null),this.container.list.sort(this.depth.fn),void 0!==this.scene.matter&&void 0!==this.scene.matter.world.debugGraphic&&(this.scene.matter.world.debugGraphic.cameraFilter=this.container.cameraFilter)}onDestroy(){super.onDestroy()}debug(e){return void 0===e&&(e=!0),"boolean"!=typeof e?this:(this.gridUpdate=null,this.grid.visible===e?this:void(this.gridUpdate=e))}set projection(e){return this._projection.setValues(e.v00,e.v01,e.v10,e.v11),this.depth.setup(),this.grid.visible&&(this.gridUpdate=!0),this._projection}get projection(){return this._projection}register(e,t){return this.scene.pool.register(e,t,this.createInstanceFn),this}add(e,t,s){let i=this.scene.pool.obtain(e);return null===i?null:(this.container.add(i),i.setTransform(t,s),i)}remove(e){return this.container.remove(e),this.scene.pool.release(e),this}},U=class extends C{onCreate(){super.onCreate()}onUpdate(e,t){super.onUpdate(e,t)}onDestroy(){super.onDestroy()}},_=class extends x{constructor(){super(...arguments),this.ui=null,this.world=null}beforeInit(){this.world=this.features.register("world",R),this.ui=this.features.register("ui",U)}},N=s(6894),F=s(1809),k=class extends r.zv{constructor(e,t){super(),this.scene=null,this.game=null,this.base=null,this._hidden=!1,this.scene=e,this.game=e.game,this.base=t}draw(){}doUpdate(){}dispose(){}},A=class{constructor(){this.ref=null,this.proxyList=[]}setRef(e){this.ref=e;for(let t of this.proxyList)t.setRef(e)}getRef(){return this.ref}removeRef(){this.ref=null;for(let e of this.proxyList)e.removeRef()}};class P extends A{get x(){return null===this.ref?0:this.ref.x}set x(e){if(null===this.ref)return 0;this.ref.setX(e)}get y(){return null===this.ref?0:this.ref.y}set y(e){if(null===this.ref)return 0;this.ref.setY(e)}}class D extends A{get x(){return null===this.ref?0:this.ref.scaleX}set x(e){if(null===this.ref)return 0;this.ref.setScale(e,this.ref.scaleX)}get y(){return null===this.ref?0:this.ref.scaleY}set y(e){if(null===this.ref)return 0;this.ref.setScale(this.ref.scaleX,e)}}class V extends A{get x(){return null===this.ref||void 0===this.ref.transform?0:this.ref.transform.x}set x(e){if(null===this.ref||void 0===this.ref.transform)return 0;this.ref.setTransformX(e)}get y(){return null===this.ref||void 0===this.ref.transform?0:this.ref.transform.y}set y(e){if(null===this.ref||void 0===this.ref.transform)return 0;this.ref.setTransformY(e)}}var $=class extends A{constructor(){super(...arguments),this.position=new P,this.transform=new V,this.scale=new D,this.proxyList=[this.position,this.transform,this.scale]}get id(){return null===this.ref?"N/A":this.ref.id||"N/A"}get name(){return null===this.ref?"N/A":this.ref.name||"N/A"}get type(){return null===this.ref?"N/A":this.ref.type}get visible(){return null!==this.ref&&this.ref.visible}set visible(e){if(null===this.ref)return!1;this.ref.setVisible(e)}get alpha(){return null===this.ref?1:this.ref.alpha}set alpha(e){if(null===this.ref)return 1;this.ref.setAlpha(e)}get angle(){return null===this.ref?0:this.ref.angle}set angle(e){if(null===this.ref)return 0;this.ref.setAngle(e)}},B=class extends k{constructor(){super(...arguments),this.objectLayer=null,this.gameObjectHandler=new $,this.components={id:null,name:null,visible:null,alpha:null,name:null,coordsXY:null,transformXY:null,scaleXY:null,angle:null,focusBtn:null},this.onFocus=()=>{let e=this.scene.features.get(this.objectLayer);null!==e&&e.camera.centerOn(this.gameObjectHandler.position.x,this.gameObjectHandler.position.y)}}draw(){this.components.id=this.base.addBlade({view:"text",disabled:!0,label:"ID",parse:e=>e,value:"N/A"}),this.components.name=this.base.addBlade({view:"text",disabled:!0,label:"Name",parse:e=>e,value:"N/A"}),this.components.type=this.base.addBlade({view:"text",disabled:!0,label:"Type",parse:e=>e,value:"N/A"}),this.components.visible=this.base.addInput(this.gameObjectHandler,"visible"),this.components.alpha=this.base.addInput(this.gameObjectHandler,"alpha",{label:"Alpha",min:0,max:1}),this.components.coordsXY=this.base.addInput(this.gameObjectHandler,"position",{label:"Position",x:{},y:{}}),this.components.transformXY=this.base.addInput(this.gameObjectHandler,"transform",{label:"Transform",x:{},y:{}}),this.components.scaleXY=this.base.addInput(this.gameObjectHandler,"scale",{label:"Scale",x:{min:.1,max:10},y:{min:.1,max:10}}),this.components.angle=this.base.addInput(this.gameObjectHandler,"angle",{label:"Angle",min:0,max:360}),this.base.addSeparator(),this.components.focusBtn=this.base.addButton({title:"Focus"}).on("click",this.onFocus)}findObjectByName(e,t){let s=this.scene.features.get(e);if(null===s)return this.showPanel(!1);let i=s.getByName(t);if(null===i)return this.showPanel(!1);this.showPanel(!0),this.base.title=`Game Object [${t}]`,this.gameObjectHandler.setRef(i),this.objectLayer=e,this.refreshComponents()}doUpdate(){this.base.hidden||this.refreshComponents()}showPanel(e){void 0===e&&(e=!0),this.base.hidden=!e}refreshComponents(){for(let e in this.components)"function"==typeof this.components[e].refresh&&this.components[e].refresh();this.components.id.value=this.gameObjectHandler.id,this.components.name.value=this.gameObjectHandler.name,this.components.type.value=this.gameObjectHandler.type,void 0===this.gameObjectHandler.getRef().transform?this.components.transformXY.disabled=!0:this.components.transformXY.disabled=!1}inspect(e){e instanceof n.GameObjects.GameObject&&(this.gameObjectHandler.setRef(e),this.base.title=`Game Object [${e.type}]`,this.showPanel(!0))}},H=class extends k{constructor(){super(...arguments),this.state={renderer:"",recording:!1},this.components={fps:null,renderer:null,screenshot:null,video:null},this.recorder=null,this.videoChunks=[],this.onScreenshot=()=>{this.game.renderer.snapshot((e=>{let t=document.createElement("a");t.href=e.src,t.download="screenshot.png",t.click()}))},this.onVideoRecord=()=>{this.state.recording?(this.stopRecording(),this.state.recording=!1,this.components.video.title="Record video"):(this.startRecording(),this.state.recording=!0,this.components.video.title="[STOP] Recording...")}}draw(){this.game.renderer.type===n.CANVAS?this.state.renderer="CANVAS":this.game.renderer.type===n.WEBGL&&(this.state.renderer="WebGL"),this.components.renderer=this.base.addMonitor(this.state,"renderer",{label:"Renrerer"}),this.base.addSeparator(),this.components.fps=this.base.addBlade({view:"fpsgraph",label:"FPS Graph",lineCount:2}),this.components.screenshot=this.base.addButton({title:"Take screenshot"}).on("click",this.onScreenshot),this.components.video=this.base.addButton({title:"Record video"}).on("click",this.onVideoRecord)}measureFPS(){this.components.fps.end(),this.components.fps.begin()}startRecording(){this.videoChunks=[];let e=this.game.canvas.captureStream(25);this.recorder=new MediaRecorder(e,{mimeType:"video/webm; codecs=vp9"}),this.recorder.start(1e3),this.recorder.ondataavailable=e=>this.accumulateChunks(e)}stopRecording(){this.recorder.onstop=e=>this.downloadVideo(e),this.recorder.stop()}accumulateChunks(e){this.videoChunks.push(e.data)}downloadVideo(){let e=new Blob(this.videoChunks,{type:"video/webm"}),t=URL.createObjectURL(e),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download","videoclip.webm"),s.click()}},X=class extends k{constructor(){super(...arguments),this.state={poolInstances:0,features:0,gameObjects:0,layerList:[],layerSelected:null,layer:{objects:0}},this.components={poolInstances:null,features:null,gameObjects:null,layerList:null,layerSeparator:null},this.onLayerListSelect=e=>{""===e.value?this.state.layerSelected=null:this.state.layerSelected=e.value,this.onLayerDisplay()}}draw(){this.components.features=this.base.addInput(this.state,"features",{label:"Features",step:1,disabled:!0}),this.components.poolInstances=this.base.addInput(this.state,"poolInstances",{label:"Pool",step:1,disabled:!0}),this.components.gameObjects=this.base.addMonitor(this.state,"gameObjects",{view:"graph",label:"Objects",max:100,min:0}),this.components.layerList=this.base.addBlade({view:"list",label:"Layer",options:this.state.layerList,value:""}),this.components.layerList.on("change",this.onLayerListSelect)}doUpdate(){this.state.poolInstances=this.scene.pool.instances,this.components.poolInstances.refresh();let e=this.scene.features.keys;this.state.features=e.length,this.state.gameObjects=0;let t=[];for(let s of e){let e=this.scene.features.get(s);e instanceof C&&(t.push(e.key),this.state.gameObjects+=e.list.length)}this.components.features.refresh(),this.components.gameObjects.refresh(),this.updateLayerList(t)}updateLayerList(e){void 0===e&&(e=[]);let t=JSON.stringify(e);this.components.layerList.hash!==t&&(this.components.layerList.hash=t,e.unshift(""),this.state.layerList=e.map((e=>({text:e,value:e}))),this.components.layerList.options=this.state.layerList,this.state.layerSelected=null,this.onLayerDisplay())}onLayerDisplay(){this.emit("layer",this.state.layerSelected)}};class Y extends A{set zoom(e){if(null===this.ref)return 1;this.ref.camera.setZoom(e)}get zoom(){return null===this.ref?1:this.ref.camera.zoom}set x(e){if(null===this.ref)return 0;this.ref.camera.centerOnX(e)}get x(){return null===this.ref?0:this.ref.camera.scrollX+this.ref.camera.centerX}set y(e){if(null===this.ref)return 0;this.ref.camera.centerOnY(e)}get y(){return null===this.ref?0:this.ref.camera.scrollY+this.ref.camera.centerY}}var G=class extends A{constructor(){super(...arguments),this.camera=new Y,this.proxyList=[this.camera]}set visible(e){if(null===this.ref)return!1;this.ref.visible=e}get visible(){return null!==this.ref&&this.ref.visible}get childs(){return null===this.ref?0:this.ref.list.length}set childs(e){}},z=class extends k{constructor(){super(...arguments),this.layerHandler=new G,this.state={objectOptions:[]},this.components={visible:null,cameraXY:null,zoom:null,searchInput:null,searchType:null,findButton:null},this.onFind=()=>{let e=this.components.searchInput.value;if(""===e)return;let t=this.components.searchType.value;this.emit("layer_search",this.layerHandler.getRef().key,t,e)}}draw(){this.components.childrens=this.base.addInput(this.layerHandler,"childs",{label:"Objects",disabled:!0,step:1}),this.components.visible=this.base.addInput(this.layerHandler,"visible"),this.components.cameraXY=this.base.addInput(this.layerHandler,"camera",{label:"Camera",x:{},y:{},expanded:!1}),this.components.zoom=this.base.addInput(this.layerHandler.camera,"zoom",{label:"Zoom",min:.1,max:3}),this.base.addSeparator(),this.components.searchType=this.base.addBlade({view:"list",label:"Search",options:[{text:"Object by name",value:"object_name"}],value:"object_name"}),this.components.searchInput=this.base.addBlade({view:"text",label:"Input",parse:e=>e,value:""}),this.components.findButton=this.base.addButton({title:"Find"}),this.components.findButton.on("click",this.onFind)}dispose(){}setLayer(e){let t=this.scene.features.get(e);if(null===e||null===t)return this.base.hidden=!0,void this.layerHandler.removeRef();this.base.hidden=!1,this.base.title=`Layer [${e}]`,this.layerHandler.setRef(t),this.refreshComponents(),this.components.searchInput.value=""}doUpdate(){this.base.hidden||(this.state.objectOptions.push({text:Math.random().toString(),value:""}),this.refreshComponents())}refreshComponents(){for(let e in this.components)"function"==typeof this.components[e].refresh&&this.components[e].refresh()}},q=class extends k{constructor(){super(...arguments),this.state={delay:0,options:[],optionHash:null},this.components={eventList:null,delay:null,fireEvent:null},this.onFireEvent=()=>{let e=this.components.eventList.value,t=this.state.delay;this.state.delay=0,""!==e&&this.scene.flow.events.trigger(e,null,t)}}draw(){this.components.eventList=this.base.addBlade({view:"list",label:"Event",options:this.state.options,value:""}),this.components.delay=this.base.addInput(this.state,"delay",{label:"Delay / s",step:.1}),this.components.fireEvent=this.base.addButton({title:"Fire event"}).on("click",this.onFireEvent),this.base.addSeparator()}doUpdate(){this.refreshComponents()}refreshComponents(){for(let i in this.components)"function"==typeof this.components[i].refresh&&this.components[i].refresh();if(null===this.scene.flow)return;let e=this.scene.flow.events.keys,t=e.join("");if(t===this.components.eventList.hash)return;this.components.eventList.hash=t;let s=e.map((e=>({text:e,value:e})));s.unshift({text:"",value:""}),this.components.eventList.options=s,this.components.eventList.value="",this.state.delay=0}};class Z extends j{constructor(){super(...arguments),this.pane=null,this.panels={inspector:null,overview:null,flow:null,layer:null,gameObject:null},this.updateLoop=null}onCreate(){this.pane=new N.Pane({title:"Debugger"}),this.pane.registerPlugin(F),this.panels.inspector=new H(this.scene,this.pane),this.panels.inspector.draw();let e=this.pane.addFolder({title:"Flow Events"});this.panels.flow=new q(this.scene,e),this.panels.flow.draw();let t=this.pane.addFolder({title:"Scene Objects"});this.panels.overview=new X(this.scene,t),this.panels.overview.draw(),this.panels.overview.on("layer",this.onLayerChange,this);let s=this.pane.addFolder({title:"Layer",expanded:!0,hidden:!0});this.panels.layer=new z(this.scene,s),this.panels.layer.draw(),this.panels.layer.on("layer_search",this.onLayerSearch,this);let i=this.pane.addFolder({title:"Game Object",expanded:!0,hidden:!0});this.panels.gameObject=new B(this.scene,i),this.panels.gameObject.draw(),this.updateLoop=this.scene.time.addEvent({delay:200,callback:this.onTick,callbackScope:this,loop:!0}),this.onTick()}onUpdate(e,t){this.panels.inspector.measureFPS()}onTick(){for(let e in this.panels)this.panels[e].doUpdate()}onDestroy(){for(let e in this.panels)this.panels[e].dispose();this.pane.dispose(),this.updateLoop.remove(),this.updateLoop.destroy()}onLayerChange(e){this.panels.layer.setLayer(e)}onLayerSearch(e,t,s){"object_name"===t&&this.panels.gameObject.findObjectByName(e,s)}inspect(e){return this.panels.gameObject.inspect(e),this}addPanel(e,t,s){void 0===s&&(s=null);let i=this.pane.addFolder({title:null===s?e:s});if("string"!=typeof e||void 0!==this.panels[e])throw new Error(`panel key=${e} is laready taken`);let n=new t(this.scene,i);return this.panels[e]=n,n}getPanel(e){return this.panels[e]||null}}Z.Panel=k,Z.GameObjectPanel=B;var K=Z;class W extends M{constructor(){super(...arguments),this.canvas=null}onCreate(){this.canvas=this.scene.add.graphics(),this.add(this.canvas),this.canvas.fillStyle(16777215,1),this.canvas.fillCircle(0,0,10)}}class J extends O{onFire(){console.log("here ?")}}var Q=[{slug:"hello-world",title:"Hello World",sceneFile:"HelloWorld.js",description:"",imageUrl:"",imageAlt:"",sceneClass:class extends _{onInit(){this.world.debug()}onLoad(){}onCreate(){let e=this.features.register("debugger",K);this.flow.events.add("simple",J),this.world.register("circle",W);let t=this.world.add("circle",0,0);e.inspect(t.canvas),t.setName("circle1")}onDestroy(){}}}];const ee=e=>Q.find((t=>t.slug===e))||null,te=()=>Q}}]);